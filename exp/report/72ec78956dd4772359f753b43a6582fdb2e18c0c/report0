==================================================================
BUG: KASAN: stack-out-of-bounds in user_mode home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/include/asm/ptrace.h:136 [inline]
BUG: KASAN: stack-out-of-bounds in unwind_next_frame+0x108/0x2580 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/kernel/unwind_orc.c:431
Read of size 8 at addr ffffc900041af950 by task syz-executor.0/28681

CPU: 2 PID: 28681 Comm: syz-executor.0 Not tainted 5.19.0-rc3-32288-g0f3b08299494 #15
Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS rel-1.14.0-0-g155821a1990b-prebuilt.qemu.org 04/01/2014
Call Trace:
 <IRQ>
 __dump_stack home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/lib/dump_stack.c:88 [inline]
 dump_stack_lvl+0x20a/0x302 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/lib/dump_stack.c:106
 print_address_description+0x65/0x4f0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/report.c:313
 print_report+0xf4/0x1e0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/report.c:429
 kasan_report+0xe5/0x110 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/report.c:491
 user_mode home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/include/asm/ptrace.h:136 [inline]
 unwind_next_frame+0x108/0x2580 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/kernel/unwind_orc.c:431
 arch_stack_walk+0xb2/0xe0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/kernel/stacktrace.c:25
 stack_trace_save+0x104/0x1e0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/stacktrace.c:122
 kasan_save_stack home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/common.c:38 [inline]
 kasan_set_track home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/common.c:45 [inline]
 set_alloc_info home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/common.c:436 [inline]
 __kasan_slab_alloc+0x80/0xb0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/kasan/common.c:469
 kasan_slab_alloc home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/include/linux/kasan.h:224 [inline]
 slab_post_alloc_hook home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/slab.h:750 [inline]
 slab_alloc_node home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/slub.c:3243 [inline]
 kmem_cache_alloc_node+0x4aa/0x630 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/slub.c:3293
 __alloc_skb+0xef/0x460 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/net/core/skbuff.c:414
 alloc_skb home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/include/linux/skbuff.h:1426 [inline]
 wg_packet_send_keepalive+0x7e/0x470 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/drivers/net/wireguard/send.c:226
 call_timer_fn+0xfb/0x230 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/time/timer.c:1474
 expire_timers home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/time/timer.c:1519 [inline]
 __run_timers+0x78f/0x9a0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/time/timer.c:1790
 run_timer_softirq+0x63/0xf0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/time/timer.c:1803
 __do_softirq+0x372/0x783 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/softirq.c:571
 __irq_exit_rcu+0xcf/0x160 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/softirq.c:650
 irq_exit_rcu+0x5/0x20 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/softirq.c:662
 sysvec_apic_timer_interrupt+0x91/0xb0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/kernel/apic/apic.c:1106
 </IRQ>
 <TASK>
 asm_sysvec_apic_timer_interrupt+0x1b/0x20
RIP: 0010:__sanitizer_cov_trace_pc+0x42/0x60 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/kcov.c:205
Code: ff 00 74 11 f7 c2 00 01 00 00 74 35 83 b9 a4 15 00 00 00 74 2c 8b 91 80 15 00 00 83 fa 02 75 21 48 8b 91 88 15 00 00 48 8b 32 <48> 8d 7e 01 8b 89 84 15 00 00 48 39 cf 73 08 48 89 3a 48 89 44 f2
RSP: 0018:ffffc900041af8b0 EFLAGS: 00000246
RAX: ffffffff8172ca15 RBX: 0000000000000000 RCX: ffff8880261b8000
RDX: ffffc90014a3f000 RSI: 000000000003ffff RDI: 0000000000040000
RBP: ffffc900041af9b0 R08: dffffc0000000000 R09: ffffed10298ba07a
R10: ffffed10298ba07a R11: 0000000000000000 R12: 0000000000000000
R13: ffff88814c5d03a0 R14: dffffc0000000000 R15: ffff88814c5d0000
 __trampoline+0x5/0x10 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/relrazzer/trampoline/trampoline.c:17
 trampoline+0xa/0x10 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/relrazzer/trampoline/trampoline.c:32
 asm_sysvec_apic_timer_interrupt+0x1b/0x20
RIP: 0010:__sanitizer_cov_trace_pc+0x42/0x60 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/kcov.c:205
Code: ff 00 74 11 f7 c2 00 01 00 00 74 35 83 b9 a4 15 00 00 00 74 2c 8b 91 80 15 00 00 83 fa 02 75 21 48 8b 91 88 15 00 00 48 8b 32 <48> 8d 7e 01 8b 89 84 15 00 00 48 39 cf 73 08 48 89 3a 48 89 44 f2
RSP: 0018:d69241e121907c00 EFLAGS: 00000246
RAX: 170f12001a131100 RBX: ffffffff85ca3810 RCX: 0000960000000016
RDX: ffffc90000009600 RSI: 000000000003ffff RDI: 0000000000040000
RBP: ffffffff9004e6ae R08: 010004157f1c0300 R09: 00008a3b000004bf
R10: 0000000500004500 R11: 0000000000000000 R12: 0000000041b58ab3
R13: 1ffff92000835f1c R14: ffff88814c5d0278 R15: dffffc0000000000
 </TASK>

The buggy address belongs to stack of task syz-executor.0/28681
 and is located at offset 112 in frame:
 tty_set_termios+0x0/0x2820 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/drivers/tty/tty_ioctl.c:323

This frame has 1 object:
 [32, 76) 'old_termios'

The buggy address belongs to the virtual mapping at
 [ffffc900041a8000, ffffc900041b1000) created by:
 dup_task_struct home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:978 [inline]
 copy_process+0x722/0x6510 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2073

The buggy address belongs to the physical page:
page:ffffea0001f4f480 refcount:1 mapcount:0 mapping:0000000000000000 index:0x0 pfn:0x7d3d2
flags: 0xfff00000000000(node=0|zone=1|lastcpupid=0x7ff)
raw: 00fff00000000000 0000000000000000 dead000000000122 0000000000000000
raw: 0000000000000000 0000000000000000 00000001ffffffff 0000000000000000
page dumped because: kasan: bad access detected
page_owner tracks the page as allocated
page last allocated via order 0, migratetype Unmovable, gfp_mask 0x2dc2(GFP_KERNEL|__GFP_HIGHMEM|__GFP_NOWARN|__GFP_ZERO), pid 28677, tgid 28677 (syz-executor.0), ts 3320344444155, free_ts 3305455210877
 prep_new_page home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:2456 [inline]
 get_page_from_freelist+0xa7c/0xf50 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:4198
 __alloc_pages+0x30e/0x710 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:5426
 vm_area_alloc_pages home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/vmalloc.c:2927 [inline]
 __vmalloc_area_node home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/vmalloc.c:2995 [inline]
 __vmalloc_node_range+0x973/0x1820 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/vmalloc.c:3165
 alloc_thread_stack_node+0x30b/0x510 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:313
 dup_task_struct home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:978 [inline]
 copy_process+0x722/0x6510 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2073
 kernel_clone+0x22a/0x810 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2657
 __do_sys_clone home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2791 [inline]
 __se_sys_clone home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2775 [inline]
 __x64_sys_clone+0x228/0x290 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:2775
 do_syscall_x64 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/entry/common.c:51 [inline]
 do_syscall_64+0x4e/0xa0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/entry/common.c:82
 entry_SYSCALL_64_after_hwframe+0x46/0xb0
page last free stack trace:
 reset_page_owner home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/include/linux/page_owner.h:24 [inline]
 free_pages_prepare home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:1371 [inline]
 free_pcp_prepare+0xa65/0xc90 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:1421
 free_unref_page_prepare home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:3343 [inline]
 free_unref_page_list+0x140/0xea0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/page_alloc.c:3475
 release_pages+0x3f21/0x4200 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/swap.c:980
 tlb_batch_pages_flush home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/mmu_gather.c:58 [inline]
 tlb_flush_mmu_free home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/mmu_gather.c:255 [inline]
 tlb_flush_mmu+0xb36/0x1010 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/mmu_gather.c:262
 tlb_finish_mmu+0x10c/0x300 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/mmu_gather.c:353
 exit_mmap+0x230/0x720 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/mm/mmap.c:3164
 __mmput+0x13d/0x400 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/fork.c:1189
 exit_mm+0x209/0x2f0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/exit.c:511
 do_exit+0x570/0x20a0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/exit.c:784
 do_group_exit+0x24f/0x300 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/exit.c:927
 get_signal+0x2425/0x2480 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/signal.c:2857
 arch_do_signal_or_restart+0x7b/0x740 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/kernel/signal.c:869
 exit_to_user_mode_loop home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/entry/common.c:166 [inline]
 exit_to_user_mode_prepare+0x154/0x220 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/entry/common.c:201
 __syscall_exit_to_user_mode_work home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/entry/common.c:283 [inline]
 syscall_exit_to_user_mode+0x26/0x60 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/kernel/entry/common.c:294
 do_syscall_64+0x5f/0xa0 home/daeryong/workspace/relrazzer-project/relrazzer/kernels/linux/arch/x86/entry/common.c:89
 entry_SYSCALL_64_after_hwframe+0x46/0xb0

Memory state around the buggy address:
 ffffc900041af800: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00
 ffffc900041af880: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1
>ffffc900041af900: 00 00 00 00 00 04 f3 f3 f3 f3 f3 f3 00 00 00 00
                                                 ^
 ffffc900041af980: 00 00 00 00 00 00 00 00 00 00 00 00 f1 f1 f1 f1
 ffffc900041afa00: 00 00 00 00 00 04 f3 f3 f3 f3 f3 f3 00 00 00 00
==================================================================
----------------
Code disassembly (best guess):
   0:	ff 00                	incl   (%rax)
   2:	74 11                	je     0x15
   4:	f7 c2 00 01 00 00    	test   $0x100,%edx
   a:	74 35                	je     0x41
   c:	83 b9 a4 15 00 00 00 	cmpl   $0x0,0x15a4(%rcx)
  13:	74 2c                	je     0x41
  15:	8b 91 80 15 00 00    	mov    0x1580(%rcx),%edx
  1b:	83 fa 02             	cmp    $0x2,%edx
  1e:	75 21                	jne    0x41
  20:	48 8b 91 88 15 00 00 	mov    0x1588(%rcx),%rdx
  27:	48 8b 32             	mov    (%rdx),%rsi
* 2a:	48 8d 7e 01          	lea    0x1(%rsi),%rdi <-- trapping instruction
  2e:	8b 89 84 15 00 00    	mov    0x1584(%rcx),%ecx
  34:	48 39 cf             	cmp    %rcx,%rdi
  37:	73 08                	jae    0x41
  39:	48 89 3a             	mov    %rdi,(%rdx)
  3c:	48                   	rex.W
  3d:	89                   	.byte 0x89
  3e:	44                   	rex.R
  3f:	f2                   	repnz
